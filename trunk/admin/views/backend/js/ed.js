/** 
 * easyDialog v2.1
 * Url : http://stylechen.com/easydialog-v2.0.html
 * Author : chenmnkken@gmail.com
 * Date : 2012-04-12
 */
(function(l,s){var i=l.document,r=i.documentElement,J=function(){var n=i.body,t=!-[1,],o=t&&/msie 6/.test(navigator.userAgent.toLowerCase()),I=1,v="cache"+(+new Date+"").slice(-8),p={},d=function(){};d.prototype={getOptions:function(a){var b,c={},e={container:null,overlay:true,drag:true,fixed:true,follow:null,followX:0,followY:0,autoClose:0,lock:false,callback:null};for(b in e)c[b]=a[b]!==s?a[b]:e[b];d.data("options",c);return c},setBodyBg:function(){if(n.currentStyle.backgroundAttachment!=="fixed"){n.style.backgroundImage=
"url(about:blank)";n.style.backgroundAttachment="fixed"}},appendIframe:function(a){a.innerHTML='<iframe style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:-1;border:0 none;filter:alpha(opacity=0)"></iframe>'},setFollow:function(a,b,c,e){b=typeof b==="string"?i.getElementById(b):b;a=a.style;a.position="absolute";a.left=d.getOffset(b,"left")+c+"px";a.top=d.getOffset(b,"top")+e+"px"},setPosition:function(a,b){var c=a.style;c.position=o?"absolute":b?"fixed":"absolute";if(b){if(o)c.setExpression("top",
'fuckIE6=document.documentElement.scrollTop+document.documentElement.clientHeight/2+"px"');else c.top="50%";c.left="50%"}else{o&&c.removeExpression("top");c.top=r.clientHeight/2+d.getScroll("top")+"px";c.left=r.clientWidth/2+d.getScroll("left")+"px"}},createOverlay:function(){var a=i.createElement("div"),b=a.style;b.cssText="margin:0;padding:0;border:none;width:100%;height:100%;background:#333;opacity:0.6;filter:alpha(opacity=60);z-index:9999;position:fixed;top:0;left:0;";if(o){n.style.height="100%";
b.position="absolute";b.setExpression("top",'fuckIE6=document.documentElement.scrollTop+"px"')}a.id="overlay";return a},createDialogBox:function(){var a=i.createElement("div");a.style.cssText="margin:0;padding:0;border:none;z-index:10000;";a.id="easyDialogBox";return a},createDialogWrap:function(a){var b=typeof a.yesFn==="function"?'<button class="btn_highlight" id="easyDialogYesBtn">'+(typeof a.yesText==="string"?a.yesText:"\u786e\u5b9a")+"</button>":"",c=typeof a.noFn==="function"||a.noFn===true?
'<button class="btn_normal" id="easyDialogNoBtn">'+(typeof a.noText==="string"?a.noText:"\u53d6\u6d88")+"</button>":"";a=['<div class="easyDialog_content">',a.header?'<h4 class="easyDialog_title" id="easyDialogTitle"><a href="javascript:void(0)" title="\u5173\u95ed\u7a97\u53e3" class="close_btn" id="closeBtn">&times;</a>'+a.header+"</h4>":"",'<div class="easyDialog_text">'+a.content+"</div>",b===""&&c===""?"":'<div class="easyDialog_footer">'+c+b+"</div>","</div>"].join("");b=i.getElementById("easyDialogWrapper");
if(!b){b=i.createElement("div");b.id="easyDialogWrapper";b.className="easyDialog_wrapper"}b.innerHTML=a.replace(/<[\/]*script[\s\S]*?>/ig,"");return b}};d.data=function(a,b,c){if(typeof a==="string"){if(b!==s)p[a]=b;return p[a]}else if(typeof a==="object"){a=a===l?0:a.nodeType===9?1:a[v]?a[v]:a[v]=++I;a=p[a]?p[a]:p[a]={};if(c!==s)a[b]=c;return a[b]}};d.removeData=function(a,b){if(typeof a==="string")delete p[a];else if(typeof a==="object"){var c=a===l?0:a.nodeType===9?1:a[v];if(c!==s){var e=function(h){for(var f in h)return false;
return true},g=function(){delete p[c];if(!(c<=1))try{delete a[v]}catch(h){a.removeAttribute(v)}};if(b){delete p[c][b];e(p[c])&&g()}else g()}}};d.event={bind:function(a,b,c){var e=d.data(a,"e"+b)||d.data(a,"e"+b,[]);e.push(c);if(e.length===1){c=this.eventHandler(a);d.data(a,b+"Handler",c);if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent&&a.attachEvent("on"+b,c)}},unbind:function(a,b,c){var e=d.data(a,"e"+b);if(e){if(c)for(var g=e.length-1,h=e[g];g>=0;g--)h===c&&e.splice(g,1);
else e=s;if(!e||!e.length){c=d.data(a,b+"Handler");if(a.addEventListener)a.removeEventListener(b,c,false);else a.attachEvent&&a.detachEvent("on"+b,c);d.removeData(a,b+"Handler");d.removeData(a,"e"+b)}}},eventHandler:function(a){return function(b){b=d.event.fixEvent(b||l.event);for(var c=d.data(a,"e"+b.type),e=0,g;g=c[e++];)if(g.call(a,b)===false){b.preventDefault();b.stopPropagation()}}},fixEvent:function(a){if(a.target)return a;var b={},c;b.target=a.srcElement||document;b.preventDefault=function(){a.returnValue=
false};b.stopPropagation=function(){a.cancelBubble=true};for(c in a)b[c]=a[c];return b}};d.capitalize=function(a){var b=a.charAt(0);return b.toUpperCase()+a.replace(b,"")};d.getScroll=function(a){a=this.capitalize(a);return r["scroll"+a]||n["scroll"+a]};d.getOffset=function(a,b){var c=this.capitalize(b);c=r["client"+c]||n["client"+c]||0;var e=this.getScroll(b),g=a.getBoundingClientRect();return Math.round(g[b])+e-c};d.drag=function(a,b){var c="getSelection"in l?function(){l.getSelection().removeAllRanges()}:
function(){try{i.selection.empty()}catch(k){}},e=this,g=e.event,h=false,f=t?a:i,j=b.style.position==="fixed",q=d.data("options").fixed;g.bind(a,"mousedown",function(k){h=true;var m=e.getScroll("top"),w=e.getScroll("left"),x=j?0:w,A=j?0:m;d.data("dragData",{x:k.clientX-e.getOffset(b,"left")+(j?w:0),y:k.clientY-e.getOffset(b,"top")+(j?m:0),el:x,et:A,er:x+r.clientWidth-b.offsetWidth,eb:A+r.clientHeight-b.offsetHeight});if(t){o&&q&&b.style.removeExpression("top");a.setCapture()}g.bind(f,"mousemove",y);
g.bind(f,"mouseup",B);t&&g.bind(a,"losecapture",B);k.stopPropagation();k.preventDefault()});var y=function(k){if(h){c();var m=d.data("dragData"),w=k.clientX-m.x,x=k.clientY-m.y,A=m.et,E=m.er,F=m.eb;m=m.el;var C=b.style;C.marginLeft=C.marginTop="0px";C.left=(w<=m?m:w>=E?E:w)+"px";C.top=(x<=A?A:x>=F?F:x)+"px";k.stopPropagation()}},B=function(k){h=false;t&&g.unbind(a,"losecapture",arguments.callee);g.unbind(f,"mousemove",y);g.unbind(f,"mouseup",arguments.callee);if(t){a.releaseCapture();if(o&&q){var m=
parseInt(b.style.top)-e.getScroll("top");b.style.setExpression("top","fuckIE6=document.documentElement.scrollTop+"+m+'+"px"')}}k.stopPropagation()}};var u,G=function(a){a.keyCode===27&&D.close()},D={open:function(a){var b=new d,c=b.getOptions(a||{});a=d.event;var e=this,g,h,f,j;if(u){clearTimeout(u);u=s}if(c.overlay){g=i.getElementById("overlay");if(!g){g=b.createOverlay();n.appendChild(g);o&&b.appendIframe(g)}g.style.display="block"}o&&b.setBodyBg();h=i.getElementById("easyDialogBox");if(!h){h=b.createDialogBox();
n.appendChild(h)}if(c.follow){f=function(){b.setFollow(h,c.follow,c.followX,c.followY)};f();a.bind(l,"resize",f);d.data("follow",f);if(g)g.style.display="none";c.fixed=false}else b.setPosition(h,c.fixed);h.style.display="block";if(!c.follow&&!c.fixed){f=function(){b.setPosition(h,false)};a.bind(l,"resize",f);d.data("resize",f)}f=typeof c.container==="string"?i.getElementById(c.container):b.createDialogWrap(c.container);if(j=h.getElementsByTagName("*")[0]){if(j&&f!==j){j.style.display="none";n.appendChild(j);
h.appendChild(f)}}else h.appendChild(f);f.style.display="block";j=f.offsetWidth;var q=f.offsetHeight;f.style.marginTop=f.style.marginRight=f.style.marginBottom=f.style.marginLeft="0px";if(c.follow)h.style.marginLeft=h.style.marginTop="0px";else{h.style.marginLeft="-"+j/2+"px";h.style.marginTop="-"+q/2+"px"}if(o&&!c.overlay){h.style.width=j+"px";h.style.height=q+"px"}f=i.getElementById("closeBtn");j=i.getElementById("easyDialogTitle");q=i.getElementById("easyDialogYesBtn");var y=i.getElementById("easyDialogNoBtn");
q&&a.bind(q,"click",function(k){c.container.yesFn.call(e,k)!==false&&e.close()});if(y){var B=function(k){if(c.container.noFn===true||c.container.noFn.call(e,k)!==false)e.close()};a.bind(y,"click",B);f&&a.bind(f,"click",B)}else f&&a.bind(f,"click",e.close);c.lock||a.bind(i,"keyup",G);if(c.autoClose&&typeof c.autoClose==="number")u=setTimeout(e.close,c.autoClose);if(c.drag&&j){j.style.cursor="move";d.drag(j,h)}d.data("dialogElements",{overlay:g,dialogBox:h,closeBtn:f,dialogTitle:j,dialogYesBtn:q,dialogNoBtn:y})},
close:function(){var a=d.data("options"),b=d.data("dialogElements"),c=d.event;if(u){clearTimeout(u);u=s}if(a.overlay&&b.overlay)b.overlay.style.display="none";b.dialogBox.style.display="none";o&&b.dialogBox.style.removeExpression("top");b.closeBtn&&c.unbind(b.closeBtn,"click");b.dialogTitle&&c.unbind(b.dialogTitle,"mousedown");b.dialogYesBtn&&c.unbind(b.dialogYesBtn,"click");b.dialogNoBtn&&c.unbind(b.dialogNoBtn,"click");if(!a.follow&&!a.fixed){c.unbind(l,"resize",d.data("resize"));d.removeData("resize")}if(a.follow){c.unbind(l,
"resize",d.data("follow"));d.removeData("follow")}a.lock||c.unbind(i,"keyup",G);typeof a.callback==="function"&&a.callback.call(D);d.removeData("options");d.removeData("dialogElements")}};return D},z=function(){l.easyDialog=J()},H=function(){if(!i.body){try{r.doScroll("left")}catch(n){setTimeout(H,1);return}z()}};(function(){if(i.body)z();else if(i.addEventListener){i.addEventListener("DOMContentLoaded",function(){i.removeEventListener("DOMContentLoaded",arguments.callee,false);z()},false);l.addEventListener("load",
z,false)}else if(i.attachEvent){i.attachEvent("onreadystatechange",function(){if(i.readyState==="complete"){i.detachEvent("onreadystatechange",arguments.callee);z()}});l.attachEvent("onload",z);var n=false;try{n=l.frameElement==null}catch(t){}r.doScroll&&n&&H()}})()})(window,undefined);
